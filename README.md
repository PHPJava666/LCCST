# LCCST: Loosely Coupled Closed-loop Student Teacher Model for Semi-supervised Medical Image Segmentation

#### [Yajun Liu], [Zenghui Zhang], [Jiang Yue], [Dongying Li], [Wenxian Yu]



Pytorch implementation of our paper: "LCCST: Loosely Coupled Closed-loop Student Teacher Model for Semi-supervised Medical Image Segmentation".
## Contents
- [Abstract](##Abstract)
- [Introduction](##Introduction)
- [Requirements](##Requirements)
- [Datasets](##Datasets)
- [Usage](##Usage)
- [Acknowledgements](##Acknowledgements)

## Abstract![LCCST10281](https://github.com/user-attachments/assets/954312da-e3ea-45b0-9f5d-b71c23909878)


Semi-supervised learning methods based on the mean-teacher (MT) paradigm have demonstrated remarkable performance in semi-supervised medical image segmentation. However, these approaches encounter the challenge of a tightly coupled relationship between the teacher and student models, which limits the student model's capacity to learn diverse features. To address this issue, we introduce a novel architecture called the Loosely Coupled Closed-loop Student-Teacher (LCCST) model for semi-supervised medical image segmentation. This framework consists of one teacher network, denoted as T, and two student networks, S1 and S2. 
Specifically, the parameters of the teacher network T are updated using an exponential moving average (EMA) of the student network S1, maintaining consistency with traditional teacher-student model frameworks. The pseudo-labels generated by the teacher network T are refined through a novel pseudo-label rectification module, which subsequently guides the independent student network S2. Simultaneously, information exchange between student networks S1 and S2 is facilitated through two distinct mutual learning strategies incorporated within the mutual learning module. This closed-loop learning mechanism enables the LCCST model to establish a loosely coupled relationship between S1 and T, allowing the teacher to provide more reliable pseudo-labels to S2. Besides, information is exchanged between S1 and S2 at both pixel and holistic levels, enhancing the overall performance and robustness of the segmentation process.

## Introduction
Official code for "LCCST: Loosely Coupled Closed-loop Student Teacher Model for Semi-supervised Medical Image Segmentation".


## Requirements
This repository is based on PyTorch 1.8.0, CUDA 11.3 and Python 3.8.10. All experiments in our paper were conducted on NVIDIA Quadro RTX 6000 24GB GPU with an identical experimental setting.
## Datasets
**Preprocess**: refer to the image pre-processing method in [CoraNet](https://github.com/koncle/CoraNet) and [BCP](https://github.com/DeepMed-Lab-ECNU/BCP) for the Pancreas dataset, Left atrium and ACDC dataset. 
The `dataloaders` folder contains the necessary code to preprocess the Left atrium and ACDC dataset. 
Pancreas pre-processing code can be got at [CoraNet](https://github.com/koncle/CoraNet).

**Dataset split**: The `./Datasets` folder contains the information about the train-test split for all three datasets.
## Usage
We provide `code`, `data_split` and `models` (Include pre-trained models and fully trained models) for Pancreas, LA and ACDC dataset.

Data could be got at [Pancreas](https://wiki.cancerimagingarchive.net/display/Public/Pancreas-CT), [LA](https://github.com/yulequan/UA-MT/tree/master/data) and [ACDC](https://github.com/HiLab-git/SSL4MIS/tree/master/data/ACDC).

To train a model,
```
python ./code/pancreas/Pancreas_train.py  #for Pancreas training
python ./code/LA_train.py  #for LA training
python ./code/ACDC_train.py  #for ACDC training
``` 

To test a model,
```
python ./code/pancreas/test_Pancreas.py  #for Pancreas testing
python ./code/test_LA.py  #for LA testing
python ./code/test_ACDC.py  #for ACDC testing
```

## Acknowledgements
Our code is largely based on [BCP](https://github.com/DeepMed-Lab-ECNU/BCP). Thanks for these authors for their valuable work, hope our work can also contribute to related research.
